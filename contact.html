<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact | ClearAxis Advisory</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body class="no-scroll">

<header class="site-header">
  <div class="container nav">
    <div class="brand">
      <img src="assets/branding/logo.png" alt="ClearAxis Advisory Logo" class="logo">
    </div>
    <nav>
      <a href="index.html" class="nav-link">Home</a>
      <a href="services.html" class="nav-link">Services</a>
      <a href="case-studies.html" class="nav-link">Case Studies</a>
      <a href="about.html" class="nav-link">About</a>
      <a href="contact.html" class="btn btn-primary nav-cta active">Contact</a>
    </nav>
  </div>
</header>

<main class="section section-intro">
  <div class="container narrow">
    <div class="contact-hero">
      <div class="contact-hero-text">
        <h1>Contact ClearAxis</h1>
        <p class="lead">
          Share a few details and weâ€™ll follow up with a clear plan to clean,
          analyze, or automate your data.
        </p>
      </div>
    </div>
  </div>
</main>

<section class="contact-section">
  <div class="contact-grid">

    <!-- LEFT COLUMN -->
    <div class="contact-form-card">
      <h2>Send a message</h2>

      <!-- Selected Services Display -->
      <div id="selected-services" class="selected-services" style="display: none;">
        <h3 style="margin-bottom: 10px;">Requesting services for:</h3>
        <div id="services-list" style="margin-bottom: 15px;"></div>
        <button type="button" id="add-service-btn" class="btn btn-secondary" style="margin-bottom: 20px;">+ Add Another Service</button>
      </div>

      <!-- Service Selection Modal -->
      <div id="service-modal" class="service-modal" style="display: none;">
        <div class="modal-overlay"></div>
        <div class="modal-content">
          <h3>Select a Service</h3>
          <div id="service-options"></div>
          <button type="button" class="btn btn-secondary" onclick="document.getElementById('service-modal').style.display = 'none'">Close</button>
        </div>
      </div>

      <form class="contact-form" id="contact-form" novalidate>

        <div class="form-row">
          <label class="form-field">
            <input type="text" name="name" placeholder="Your name" required />
          </label>

          <label class="form-field">
            <input type="email" name="email" placeholder="Email address" required />
          </label>
        </div>

        <label class="form-field">
          <input type="text" name="company" placeholder="Company (optional)" />
        </label>

        <label class="form-field">
          <textarea name="message" id="messageBox"
            rows="6"
            placeholder="Briefly describe your needs"
            maxlength="500"
            required></textarea>
          <span class="char-counter">0 / 500</span>
        </label>

        <div class="form-row form-actions">
          <button class="btn btn-primary" type="submit">
            Send Message
          </button>
        </div>

      </form>
    </div>

    <!-- RIGHT COLUMN -->
    <div class="contact-info">

      <div class="info-card">
        <h4>Our approach</h4>
        <p>ClearAxis combines structured KPI frameworks with practical automation and decision-focused reporting systems.</p>
      </div>

      <div class="info-card">
        <h4>Hours</h4>
        <p>Monâ€“Fri, 8:00â€“19:00 (EST)</p>
      </div>

      <div class="info-card">
        <h4>Email</h4>
        <p><a href="mailto:contact@clearaxisadvisory.com">contact@clearaxisadvisory.com</a></p>
      </div>

    </div>

  </div>
</section>

<footer class="site-footer">
  <div class="container">
    <p>Â© 2026 ClearAxis Advisory. All rights reserved.</p>
  </div>
</footer>

<script>
const services = [
  { name: "KPI Architecture & Performance Diagnostic", value: "KPI Audit & Performance Diagnostic" },
  { name: "Executive Dashboard & Reporting Systems", value: "Executive Dashboard Design" },
  { name: "Automation & Data Workflow Optimization", value: "Performance Automation & Monitoring" }
];

const form = document.getElementById("contact-form");
const nameInput = form.querySelector('input[name="name"]');
const emailInput = form.querySelector('input[name="email"]');
const messageInput = document.getElementById("messageBox");
const counter = document.querySelector(".char-counter");
const selectedServicesDiv = document.getElementById("selected-services");
const servicesList = document.getElementById("services-list");
const addServiceBtn = document.getElementById("add-service-btn");
const serviceModal = document.getElementById("service-modal");
const serviceOptions = document.getElementById("service-options");

let selectedServices = [];

function getQueryParam(param) {
  const urlParams = new URLSearchParams(window.location.search);
  return urlParams.get(param);
}

function formatMessageWithServices() {
  let messageText = "";
  if (selectedServices.length > 0) {
    selectedServices.forEach(service => {
      messageText += `**${service}**\n`;
    });
    messageText += "\n";
  }
  return messageText;
}

function updateServicesList() {
  servicesList.innerHTML = "";
  selectedServices.forEach((service, index) => {
    const tag = document.createElement("div");
    tag.style.cssText = "display: inline-block; background: #f0f0f0; padding: 8px 12px; margin-right: 8px; margin-bottom: 8px; border-radius: 4px; font-weight: bold;";
    tag.innerHTML = `${service} <button type="button" onclick="removeService(${index})" style="background: none; border: none; margin-left: 8px; cursor: pointer; font-weight: bold;">Ã—</button>`;
    servicesList.appendChild(tag);
  });
  
  if (selectedServices.length > 0) {
    selectedServicesDiv.style.display = "block";
    updateMessageWithServices();
  } else {
    selectedServicesDiv.style.display = "none";
  }
}

function addService(service) {
  if (!selectedServices.includes(service)) {
    selectedServices.push(service);
  }
  updateServicesList();
  serviceModal.style.display = "none";
}

window.removeService = function(index) {
  selectedServices.splice(index, 1);
  updateServicesList();
};

function populateServiceOptions() {
  serviceOptions.innerHTML = "";
  services.forEach(service => {
    const btn = document.createElement("button");
    btn.type = "button";
    btn.className = "btn btn-primary";
    btn.style.cssText = "display: block; width: 100%; text-align: left; margin-bottom: 10px; padding: 12px;";
    btn.textContent = service.name;
    btn.onclick = () => addService(service.name);
    serviceOptions.appendChild(btn);
  });
}

function updateMessageWithServices() {
  const currentMessage = messageInput.value.split("\n").filter(line => !line.startsWith("**") && line.trim() !== "").join("\n");
  const servicePrefix = formatMessageWithServices();
  messageInput.value = (servicePrefix + currentMessage).trim();
  counter.textContent = messageInput.value.length + " / 500";
}

function showError(input, message) {
  input.classList.add("input-error");
  const error = document.createElement("span");
  error.className = "field-error-text";
  error.innerText = message;
  input.parentElement.appendChild(error);
}

function clearErrors() {
  document.querySelectorAll(".field-error-text").forEach(el => el.remove());
  document.querySelectorAll(".input-error").forEach(el => el.classList.remove("input-error"));
}

addServiceBtn.addEventListener("click", () => {
  populateServiceOptions();
  serviceModal.style.display = "flex";
});

document.querySelector(".modal-overlay").addEventListener("click", () => {
  serviceModal.style.display = "none";
});

messageInput.addEventListener("input", function() {
  counter.textContent = messageInput.value.length + " / 500";
});

// Check for service query parameter on page load
window.addEventListener("load", () => {
  const serviceParam = getQueryParam("service");
  if (serviceParam) {
    const displayName = services.find(s => s.value === serviceParam)?.name || serviceParam;
    addService(displayName);
  }
  populateServiceOptions();
});

form.addEventListener("submit", function(e) {
  e.preventDefault();
  clearErrors();

  let valid = true;

  if (!nameInput.value.trim()) {
    showError(nameInput, "Name is required.");
    valid = false;
  }

  if (!emailInput.value.trim()) {
    showError(emailInput, "Email is required.");
    valid = false;
  }

  if (!messageInput.value.trim()) {
    showError(messageInput, "Please describe your needs.");
    valid = false;
  }

  if (!valid) return;

  const formData = {
    name: nameInput.value,
    email: emailInput.value,
    company: document.querySelector('input[name="company"]').value,
    message: messageInput.value
  };

  // Disable button to prevent double submit
  const button = form.querySelector("button");
  button.disabled = true;
  button.innerText = "Sending...";

  // ðŸ”¥ Fade out form smoothly
  form.style.transition = "opacity 0.2s ease";
  form.style.opacity = "0";

  setTimeout(() => {

    // Replace with success message
    form.innerHTML = `
      <div class="form-success">
        <h3>Thank you.</h3>
        <p>Your message has been sent successfully. Weâ€™ll respond shortly.</p>
      </div>
    `;

    form.style.opacity = "1";

  }, 200);

  // ðŸš€ Send request in background (no waiting)
  fetch("https://script.google.com/macros/s/AKfycbzioBGxxaNIs3YWdeMsnzy2KYq0Qn3gEZdupCF3W8WWDfJx41dPmaxubvGvb4AoOqFr6Q/exec", {
    method: "POST",
    mode: "no-cors",
    headers: {
      "Content-Type": "application/x-www-form-urlencoded"
    },
    body: new URLSearchParams({
      name: nameInput.value,
      email: emailInput.value,
      company: document.querySelector('input[name="company"]').value,
      message: messageInput.value
    }).toString()
  });
});
</script>
</body>
</html>